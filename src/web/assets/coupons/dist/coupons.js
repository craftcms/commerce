(()=>{var e={580:()=>{},556:(e,t,n)=>{var o=n(580);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals),(0,n(673).Z)("7d5b639c",o,!0,{})},673:(e,t,n)=>{"use strict";function o(e,t){for(var n=[],o={},r=0;r<t.length;r++){var a=t[r],i=a[0],s={id:e+":"+r,css:a[1],media:a[2],sourceMap:a[3]};o[i]?o[i].parts.push(s):n.push(o[i]={id:i,parts:[s]})}return n}n.d(t,{Z:()=>f});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},i=r&&(document.head||document.getElementsByTagName("head")[0]),s=null,u=0,d=!1,l=function(){},c=null,h="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,n,r){d=n,c=r||{};var i=o(e,t);return m(i),function(t){for(var n=[],r=0;r<i.length;r++){var s=i[r];(u=a[s.id]).refs--,n.push(u)}for(t?m(i=o(e,t)):i=[],r=0;r<n.length;r++){var u;if(0===(u=n[r]).refs){for(var d=0;d<u.parts.length;d++)u.parts[d]();delete a[u.id]}}}}function m(e){for(var t=0;t<e.length;t++){var n=e[t],o=a[n.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](n.parts[r]);for(;r<n.parts.length;r++)o.parts.push(C(n.parts[r]));o.parts.length>n.parts.length&&(o.parts.length=n.parts.length)}else{var i=[];for(r=0;r<n.parts.length;r++)i.push(C(n.parts[r]));a[n.id]={id:n.id,refs:1,parts:i}}}}function g(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function C(e){var t,n,o=document.querySelector("style["+h+'~="'+e.id+'"]');if(o){if(d)return l;o.parentNode.removeChild(o)}if(p){var r=u++;o=s||(s=g()),t=F.bind(null,o,r,!1),n=F.bind(null,o,r,!0)}else o=g(),t=y.bind(null,o),n=function(){o.parentNode.removeChild(o)};return t(e),function(o){if(o){if(o.css===e.css&&o.media===e.media&&o.sourceMap===e.sourceMap)return;t(e=o)}else n()}}var v,b=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function F(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=b(t,r);else{var a=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function y(e,t){var n=t.css,o=t.media,r=t.sourceMap;if(o&&e.setAttribute("media",o),c.ssrId&&e.setAttribute(h,t.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={id:o,exports:{}};return e[o](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}n(556),"undefined"===e(Craft.Commerce)&&(Craft.Commerce={}),Craft.Commerce.Coupons=Garnish.Base.extend({couponsTable:null,couponFormat:null,hud:null,$couponsContainer:null,$couponFormatField:null,$generateBtn:null,$generateHudBody:null,$hudFormatField:null,$hudCountField:null,$hudSubmitButton:null,init:function(e,t){this.setSettings(t,Craft.Commerce.Coupons.defaults),this.$couponsContainer=$(this.settings.couponsContainerSelector),this.$couponFormatField=this.$couponsContainer.find(this.settings.couponFormatFieldSelector),this.$generateBtn=$(this.settings.generateBtnSelector),this.addListener(this.$generateBtn,"click","showGenerateHud"),this.couponsTable=new Craft.EditableTable(this.settings.couponsTableId,this.settings.table.name,this.settings.table.cols,{defaultValues:this.settings.table.defaultValues,staticRows:!1,minRows:null,allowAdd:!0,allowDelete:!0,maxRows:null})},showGenerateHud:function(){if(!this.hud)return this.$generateHudBody=$("<div/>").attr("id","commerce-coupons-hud"),this.$hudCountField=Craft.ui.createTextField({label:Craft.t("commerce","Number of Coupons"),name:"couponCount",type:"number",value:1,max:400}).appendTo(this.$generateHudBody),this.$hudFormatField=Craft.ui.createTextField({label:Craft.t("commerce","Generated Coupon Format"),name:"couponFormat",type:"text",instructions:Craft.t("commerce","The format used to generate new coupons."),value:this.settings.couponFormat,tip:Craft.t("commerce","e.g. summer_####. # characters will be replaced with a random letter.")}),this.$generateHudBody.append(this.$hudFormatField),this.$hudSubmitButton=Craft.ui.createSubmitButton({spinner:!0}).appendTo(this.$generateHudBody),void(this.hud=new Garnish.HUD(this.$generateBtn,this.$generateHudBody,{hudClass:"hud",onSubmit:$.proxy(this,"generateCoupons")}));this.hud.show()},generateCoupons:function(){var e=this;if(this.$hudSubmitButton.addClass("loading"),Craft.ui.clearErrorsFromField(this.$hudFormatField),-1===this.$hudFormatField.find("input").val().indexOf("#"))return Craft.ui.addErrorsToField(this.$hudFormatField,[Craft.t("commerce","Coupon format is required and must contain at least one `#`.")]),void this.$hudSubmitButton.removeClass("loading");Craft.sendActionRequest("POST","commerce/discounts/generate-coupons",{data:this.getGenerateData()}).then((function(t){e.$couponFormatField.val(e.$hudFormatField.find("input").val());var n=t.data.coupons;n&&e.addCodes(n),e.hud.hide()})).catch((function(t){var n=t.response;n.data.message&&Craft.ui.addErrorsToField(e.$hudFormatField,[n.data.message])})).finally((function(){e.$hudSubmitButton.removeClass("loading")}))},addCodes:function(e){var t=this;e&&e.length&&e.forEach((function(e){t.couponsTable.addRow(!1,!0).$tr.find('textarea[name*="[code]"]').val(e)}))},getAllCodesFromTable:function(){var e=[];return this.couponsTable.$tbody.find('[name*="[code]"]').each((function(t,n){e.push($(n).val())})),e},getGenerateData:function(){return this.$couponsContainer?{count:this.$hudCountField.find("input").val(),format:this.$hudFormatField.find("input").val(),existingCodes:this.getAllCodesFromTable()}:{}}},{defaults:{couponsContainerSelector:"#commerce-coupons",couponFormatFieldSelector:'input[name="couponFormat"]',couponsTableId:"commerce-coupons-table",generateBtnSelector:"#commerce-coupons-generate",table:{}}})})()})();
//# sourceMappingURL=coupons.js.map